<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Planificateur d'Interventions - Assemblées de Dieu</title>
    <link rel="icon" href="AD.jpeg" type="image/jpeg">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="style.css">
</head>
<body class="theme-light">
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container-fluid d-flex align-items-center">
            <a class="navbar-brand" href="#">
                <div class="logo-container">
                    <div class="logo-text">
                        <div class="logo-ad">AD</div>
                        <div class="logo-subtitle">ASSEMBLÉES DE DIEU</div>
                    </div>
                </div>
                <span class="glow-text">Planificateur d'Interventions</span>
            </a>

            <div class="theme-selector">
                <div class="theme-btn theme-light-btn" title="Clair" onclick="changeTheme('light')"></div>
                <div class="theme-btn theme-dark-btn" title="Sombre" onclick="changeTheme('dark')"></div>
                <div class="theme-btn theme-neon-btn" title="Néon" onclick="changeTheme('neon')"></div>
                <div class="theme-btn theme-galaxy-btn" title="Galaxie" onclick="changeTheme('galaxy')"></div>
                <div class="theme-btn theme-rainbow-btn" title="Arc-en-ciel" onclick="changeTheme('rainbow')"></div>
                <div class="theme-btn theme-high-contrast-btn" title="Contraste élevé" onclick="changeTheme('high-contrast')">HC</div>
                <div class="theme-btn theme-pastel-btn" title="Pastel" onclick="changeTheme('pastel')">P</div>
            </div>

            <div class="navbar-text me-3">
                <span class="badge bg-warning text-dark">Église BERACA</span>
            </div>

            <!-- Logo AD à droite -->
            <div>
                <img src="AD.jpeg" alt="Logo AD" class="img-fluid" style="width: 80px; height: 80px; object-fit: contain; border-radius: 8px;">
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <!-- En-tête AD -->
        <div class="ad-header">
            <h1><i class="fas fa-church me-2"></i>ASSEMBLÉES DE DIEU DU BÉNIN</h1>
            <p>Plan d'Action Trimestriel - Gestion des Interventions</p>
        </div>
        
        <!-- Indicateur d'étapes -->
        <div class="step-indicator">
            <div class="step active" id="step1">
                <div class="step-number">1</div>
                <span>Configuration</span>
            </div>
            <div class="step-line" style="left: calc(25% - 40px);"></div>
            <div class="step" id="step2">
                <div class="step-number">2</div>
                <span>Interventions</span>
            </div>
            <div class="step-line" style="left: calc(75% - 40px);"></div>
            <div class="step" id="step3">
                <div class="step-number">3</div>
                <span>Export</span>
            </div>
        </div>
        
        <!-- Étape 1: Configuration -->
        <div class="step-content active" id="step1-content">
            <!-- Informations Générales -->
            <div class="card main-card">
                <div class="card-header">
                    <h4><i class="fas fa-info-circle me-2"></i>Informations Générales</h4>
                </div>
                <div class="card-body">
                    <div class="alert alert-info mb-4">
                        <i class="fas fa-lock me-2"></i>
                        Les informations générales sont protégées. Pour les modifier, entrez le mot de passe de développeur.
                        <button type="button" class="btn btn-sm btn-outline-primary ms-2" id="unlock-general-info">
                            <i class="fas fa-unlock me-1"></i>Modifier
                        </button>
                    </div>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="church-name" class="form-label">Nom de l'Église *</label>
                            <input type="text" class="form-control" id="church-name"
                                   value="EGLISE EVANGELIQUE DES ASSEMBLEES DE DIEU DU BENIN" required disabled>
                        </div>
                        <div class="col-md-3 mb-3">
                            <label for="region" class="form-label">Région *</label>
                            <input type="text" class="form-control" id="region" value="ATACORA" required disabled>
                        </div>
                        <div class="col-md-3 mb-3">
                            <label for="section" class="form-label">Section *</label>
                            <input type="text" class="form-control" id="section" value="NATITINGOU" required disabled>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4 mb-3">
                            <label for="temple" class="form-label">Temple *</label>
                            <input type="text" class="form-control" id="temple" value="BERACA" required disabled>
                        </div>
                        <div class="col-md-4 mb-3">
                            <label for="year" class="form-label">Année *</label>
                            <input type="number" class="form-control" id="year" value="2025" min="2020" max="2030" required disabled>
                        </div>
                        <div class="col-md-4 mb-3">
                            <label for="quarter" class="form-label">Trimestre *</label>
                            <select class="form-select" id="quarter" required disabled>
                                <option value="1">1er trimestre</option>
                                <option value="2">2ème trimestre</option>
                                <option value="3">3ème trimestre</option>
                                <option value="4" selected>4ème trimestre</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Configuration des Types de Cultes -->
            <div class="card main-card">
                <div class="card-header">
                    <h4><i class="fas fa-calendar-alt me-2"></i>Configuration des Types de Cultes/Réunions</h4>
                </div>
                <div class="card-body">
                    <div class="row">
                        <!-- Jours de la semaine -->
                        <div class="col-md-6 mb-4">
                            <h5 class="mb-3"><i class="fas fa-calendar-day me-2"></i>Jours de la semaine</h5>
                            <div class="checkbox-group">
                                <div class="row">
                                    <div class="col-6">
                                        <div class="form-check mb-3">
                                            <input class="form-check-input" type="checkbox" id="day-sunday" value="Dimanche" checked>
                                            <label class="form-check-label" for="day-sunday">
                                                <span class="cult-type-badge">Dimanche</span>
                                            </label>
                                        </div>
                                        <div class="form-check mb-3">
                                            <input class="form-check-input" type="checkbox" id="day-monday" value="Lundi">
                                            <label class="form-check-label" for="day-monday">
                                                <span class="cult-type-badge">Lundi</span>
                                            </label>
                                        </div>
                                        <div class="form-check mb-3">
                                            <input class="form-check-input" type="checkbox" id="day-tuesday" value="Mardi" checked>
                                            <label class="form-check-label" for="day-tuesday">
                                                <span class="cult-type-badge">Mardi</span>
                                            </label>
                                        </div>
                                        <div class="form-check mb-3">
                                            <input class="form-check-input" type="checkbox" id="day-wednesday" value="Mercredi" checked>
                                            <label class="form-check-label" for="day-wednesday">
                                                <span class="cult-type-badge">Mercredi</span>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="col-6">
                                        <div class="form-check mb-3">
                                            <input class="form-check-input" type="checkbox" id="day-thursday" value="Jeudi" checked>
                                            <label class="form-check-label" for="day-thursday">
                                                <span class="cult-type-badge">Jeudi</span>
                                            </label>
                                        </div>
                                        <div class="form-check mb-3">
                                            <input class="form-check-input" type="checkbox" id="day-friday" value="Vendredi" checked>
                                            <label class="form-check-label" for="day-friday">
                                                <span class="cult-type-badge">Vendredi</span>
                                            </label>
                                        </div>
                                        <div class="form-check mb-3">
                                            <input class="form-check-input" type="checkbox" id="day-saturday" value="Samedi">
                                            <label class="form-check-label" for="day-saturday">
                                                <span class="cult-type-badge">Samedi</span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Types de Culte -->
                        <div class="col-md-6 mb-4">
                            <h5 class="mb-3"><i class="fas fa-pray me-2"></i>Types de Culte</h5>
                            <div class="checkbox-group">
                                <div class="form-check mb-3">
                                    <input class="form-check-input" type="checkbox" id="type-principal" value="Principal" checked>
                                    <label class="form-check-label" for="type-principal">
                                        Culte Principal
                                    </label>
                                </div>
                                <div class="form-check mb-3">
                                    <input class="form-check-input" type="checkbox" id="type-enseignement" value="Enseignement" checked>
                                    <label class="form-check-label" for="type-enseignement">
                                        Enseignement
                                    </label>
                                </div>
                                <div class="form-check mb-3">
                                    <input class="form-check-input" type="checkbox" id="type-temoignage" value="Témoignage/Action de grâce/Prière" checked>
                                    <label class="form-check-label" for="type-temoignage">
                                        Témoignage/Action de grâce/Prière
                                    </label>
                                </div>
                                <div class="form-check mb-3">
                                    <input class="form-check-input" type="checkbox" id="type-priere-hebdo" value="Prière hebdomadaire" checked>
                                    <label class="form-check-label" for="type-priere-hebdo">
                                        Prière hebdomadaire
                                    </label>
                                </div>
                                <div class="form-check mb-3">
                                    <input class="form-check-input" type="checkbox" id="type-jeune-priere" value="Jeune et Prière">
                                    <label class="form-check-label" for="type-jeune-priere">
                                        Jeune et Prière
                                    </label>
                                </div>
                                <div class="form-check mb-3">
                                    <input class="form-check-input" type="checkbox" id="type-veille-priere" value="Veillée de prière">
                                    <label class="form-check-label" for="type-veille-priere">
                                        Veillée de prière
                                    </label>
                                </div>
                                <div class="form-check mb-3">
                                    <input class="form-check-input" type="checkbox" id="type-reunion" value="Réunion" checked>
                                    <label class="form-check-label" for="type-reunion">
                                        Réunion
                                    </label>
                                </div>
                                <div class="form-check mb-3">
                                    <input class="form-check-input" type="checkbox" id="type-culte-enfants" value="Culte des enfants" checked>
                                    <label class="form-check-label" for="type-culte-enfants">
                                        Culte des enfants
                                    </label>
                                </div>
                                <div class="form-check mb-3">
                                    <input class="form-check-input" type="checkbox" id="type-culte-ados" value="Culte des Adolescents">
                                    <label class="form-check-label" for="type-culte-ados">
                                        Culte des Adolescents
                                    </label>
                                </div>
                                <div class="form-check mb-3">
                                    <input class="form-check-input" type="checkbox" id="type-other" value="Autre">
                                    <label class="form-check-label" for="type-other">
                                        Autre
                                    </label>
                                    <input type="text" class="form-control mt-2" id="type-other-specify" placeholder="Précisez le type de réunion" disabled>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Lieux d'intervention -->
                    <div class="row">
                        <div class="col-12">
                            <h5 class="mb-3"><i class="fas fa-map-marker-alt me-2"></i>Lieux d'Intervention</h5>
                            <div class="checkbox-group">
                                <div class="row">
                                    <div class="col-md-4 mb-3">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="place-beraca" value="BERACA" checked>
                                            <label class="form-check-label" for="place-beraca">
                                                BERACA
                                            </label>
                                        </div>
                                    </div>
                                    <div class="col-md-4 mb-3">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="place-kpoteyei" value="KPOTEYEI" checked>
                                            <label class="form-check-label" for="place-kpoteyei">
                                                KPOTEYEI
                                            </label>
                                        </div>
                                    </div>
                                    <div class="col-md-4 mb-3">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="place-gros-porteur" value="GROS PORTEUR" checked>
                                            <label class="form-check-label" for="place-gros-porteur">
                                                GROS PORTEUR
                                            </label>
                                        </div>
                                    </div>
                                    <div class="col-md-4 mb-3">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="place-winke" value="WINKE" checked>
                                            <label class="form-check-label" for="place-winke">
                                                WINKE
                                            </label>
                                        </div>
                                    </div>
                                    <div class="col-md-4 mb-3">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="place-other" value="Autre">
                                            <label class="form-check-label" for="place-other">
                                                Autre lieu
                                            </label>
                                        </div>
                                    </div>
                                </div>
                                <div class="row mt-2">
                                    <div class="col-md-6">
                                        <input type="text" class="form-control" id="place-other-specify" placeholder="Précisez le lieu d'intervention" disabled>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="btn-row">
                        <div class="btn-group">
                            <button type="button" class="btn btn-outline-secondary" onclick="resetConfiguration()">
                                <i class="fas fa-redo me-2"></i>Réinitialiser
                            </button>
                            <button type="button" class="btn btn-outline-primary" id="manage-profiles-btn">
                                <i class="fas fa-folder-open me-2"></i>Gérer les profils
                            </button>
                        </div>
                        <button type="button" class="btn btn-primary-custom" id="next-step-1">
                            <i class="fas fa-arrow-right me-2"></i>Suivant
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Étape 2: Ajout d'interventions -->
        <div class="step-content" id="step2-content">
            <!-- Formulaire pour ajouter un nouvel intervenant -->
            <div class="card main-card mb-4">
                <div class="card-header">
                    <h4><i class="fas fa-user-plus me-2"></i>Ajouter un Nouvel Intervenant</h4>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-3 mb-3">
                            <label for="new-title" class="form-label">Titre</label>
                            <select class="form-select" id="new-title">
                                <option value="">Aucun</option>
                                <option value="Pasteur">Pasteur</option>
                                <option value="Diacre">Diacre</option>
                                <option value="Mr">Mr</option>
                                <option value="Mme">Mme</option>
                                <option value="Mlle">Mlle</option>
                                <option value="Frère">Frère</option>
                                <option value="Sœur">Sœur</option>
                                <option value="Ancien">Ancien</option>
                                <option value="Évangeliste">Évangeliste</option>
                            </select>
                        </div>
                        <div class="col-md-3 mb-3">
                            <label for="new-category" class="form-label">Catégorie</label>
                            <select class="form-select" id="new-category">
                                <option value="clergy">Clergé</option>
                                <option value="members" selected>Membres</option>
                                <option value="singers">Chanteurs</option>
                                <option value="musicians">Musiciens</option>
                                <option value="technical">Technique</option>
                                <option value="volunteers">Bénévoles</option>
                            </select>
                        </div>
                        <div class="col-md-3 mb-3">
                            <label for="new-firstname" class="form-label">Prénom *</label>
                            <input type="text" class="form-control" id="new-firstname" placeholder="Entrez le prénom" required>
                        </div>
                        <div class="col-md-2 mb-3">
                            <label for="new-lastname" class="form-label">Nom de famille *</label>
                            <input type="text" class="form-control" id="new-lastname" placeholder="Entrez le nom" required>
                        </div>
                        <div class="col-md-1 mb-3 d-flex align-items-end">
                            <button type="button" class="btn btn-success w-100" id="add-new-intervenant">
                                <i class="fas fa-plus"></i>
                            </button>
                        </div>
                    </div>
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle me-2"></i>
                        Les intervenants ajoutés seront disponibles dans les listes déroulantes ci-dessous.
                    </div>
                    <div class="d-flex justify-content-end">
                        <button type="button" class="btn btn-outline-primary" id="manage-intervenants-btn">
                            <i class="fas fa-users-cog me-2"></i>Gérer les intervenants
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Formulaire d'ajout d'intervention -->
            <div class="card main-card">
                <div class="card-header">
                    <h4><i class="fas fa-calendar-plus me-2"></i>Ajouter une Intervention</h4>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-3 mb-3">
                            <label for="intervention-date" class="form-label">Date *</label>
                            <input type="date" class="form-control" id="intervention-date" required>
                        </div>
                        <div class="col-md-3 mb-3">
                            <label for="day-of-week" class="form-label">Jour de la semaine</label>
                            <div class="date-display" id="day-of-week-display">---</div>
                            <input type="hidden" id="day-of-week">
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="intervention-place" class="form-label">Lieu d'intervention *</label>
                            <select class="form-select" id="intervention-place" required>
                                <option value="">Sélectionnez un lieu...</option>
                                <!-- Rempli dynamiquement -->
                            </select>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="cult-type-select" class="form-label">Type de culte/réunion *</label>
                            <select class="form-select" id="cult-type-select" required>
                                <option value="">Sélectionnez un type...</option>
                                <!-- Rempli dynamiquement -->
                            </select>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="cult-theme" class="form-label">Thème/Description</label>
                            <input type="text" class="form-control" id="cult-theme" 
                                   placeholder="Ex: Semaine de l'EDL, Pâques, Noël...">
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-3 mb-3">
                            <label for="intervenant-title" class="form-label">Titre</label>
                            <select class="form-select" id="intervenant-title">
                                <option value="">Aucun</option>
                                <option value="Pasteur">Pasteur</option>
                                <option value="Diacre">Diacre</option>
                                <option value="Mr">Mr</option>
                                <option value="Mme">Mme</option>
                                <option value="Mlle">Mlle</option>
                                <option value="Frère">Frère</option>
                                <option value="Sœur">Sœur</option>
                                <option value="Ancien">Ancien</option>
                                <option value="Évangeliste">Évangeliste</option>
                            </select>
                        </div>
                        <div class="col-md-4 mb-3">
                            <label for="intervenant-firstname" class="form-label">Prénom *</label>
                            <select class="form-select intervenant-select" id="intervenant-firstname" required>
                                <option value="">Sélectionnez...</option>
                                <!-- Rempli dynamiquement depuis la base -->
                            </select>
                        </div>
                        <div class="col-md-5 mb-3">
                            <label for="intervenant-lastname" class="form-label">Nom de famille *</label>
                            <select class="form-select intervenant-select" id="intervenant-lastname" required>
                                <option value="">Sélectionnez...</option>
                                <!-- Rempli dynamiquement depuis la base -->
                            </select>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-12 mb-3">
                            <label for="observations" class="form-label">Observations spécifiques</label>
                            <textarea class="form-control" id="observations" rows="2" 
                                      placeholder="Ex: Témoignage personnel, Prière pour la nation, Enseignement sur..."></textarea>
                        </div>
                    </div>
                    
                    <div class="btn-row">
                        <button type="button" class="btn btn-outline-secondary" id="prev-step-2">
                            <i class="fas fa-arrow-left me-2"></i>Retour
                        </button>
                        <div class="btn-group-custom">
                            <button type="button" class="btn btn-primary-custom" id="add-intervention-btn">
                                <i class="fas fa-plus me-2"></i>Ajouter cette intervention
                            </button>
                            <button type="button" class="btn btn-outline-primary" id="add-multiple-btn">
                                <i class="fas fa-plus-circle me-2"></i>Ajouter 4 interventions
                            </button>
                            <button type="button" class="btn btn-outline-success" id="auto-plan-btn">
                                <i class="fas fa-robot me-2"></i>Planification automatique
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Liste des interventions -->
            <div class="card main-card">
                <div class="card-header">
                    <h4><i class="fas fa-list-alt me-2"></i>Interventions Planifiées <span class="badge bg-secondary" id="intervention-count">0</span></h4>
                </div>
                <div class="card-body">
                    <!-- Barre de recherche et filtres -->
                    <div class="row mb-3">
                        <div class="col-md-4">
                            <input type="text" class="form-control" id="search-input" placeholder="Rechercher une intervention (intervenant, lieu, type, observations)...">
                        </div>
                        <div class="col-md-2">
                            <select class="form-select" id="filter-day">
                                <option value="">Tous les jours</option>
                                <option value="Dimanche">Dimanche</option>
                                <option value="Lundi">Lundi</option>
                                <option value="Mardi">Mardi</option>
                                <option value="Mercredi">Mercredi</option>
                                <option value="Jeudi">Jeudi</option>
                                <option value="Vendredi">Vendredi</option>
                                <option value="Samedi">Samedi</option>
                            </select>
                        </div>
                        <div class="col-md-3">
                            <select class="form-select" id="filter-type">
                                <option value="">Tous les types</option>
                                <!-- Rempli dynamiquement -->
                            </select>
                        </div>
                        <div class="col-md-3">
                            <select class="form-select" id="filter-place">
                                <option value="">Tous les lieux</option>
                                <!-- Rempli dynamiquement -->
                            </select>
                        </div>
                    </div>

                    <div id="interventions-list">
                        <p class="text-muted text-center py-4">
                            <i class="fas fa-inbox fa-2x mb-3 d-block"></i>
                            Aucune intervention ajoutée pour le moment.<br>
                            Commencez par ajouter des interventions ci-dessus.
                        </p>
                    </div>

                    <div class="btn-row">
                        <div class="btn-group">
                            <button type="button" class="btn btn-outline-danger" id="clear-all-btn">
                                <i class="fas fa-trash-alt me-2"></i>Vider la liste
                            </button>
                            <button type="button" class="btn btn-outline-secondary" id="clear-filters-btn">
                                <i class="fas fa-filter-circle-xmark me-2"></i>Effacer filtres
                            </button>
                            <button type="button" class="btn btn-outline-primary" id="import-excel-btn">
                                <i class="fas fa-file-import me-2"></i>Importer Excel
                            </button>
                        </div>
                        <button type="button" class="btn btn-success-custom" id="next-step-2">
                            <i class="fas fa-file-excel me-2"></i>Générer Excel
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Étape 3: Export et partage -->
        <div class="step-content" id="step3-content">
            <div class="card main-card">
                <div class="card-header">
                    <h4><i class="fas fa-file-export me-2"></i>Export et Partage</h4>
                </div>
                <div class="card-body">
                    <div class="row mb-4">
                        <div class="col-md-8">
                            <h5>Prévisualisation du fichier Excel</h5>
                            <div class="excel-preview" id="excel-preview">
                                <p class="text-muted">Générez un aperçu pour voir le contenu du fichier Excel.</p>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card main-card">
                                <div class="card-body">
                                    <h6><i class="fas fa-info-circle me-2"></i>Résumé</h6>
                                    <ul class="list-unstyled">
                                        <li class="mb-2"><i class="fas fa-church me-2"></i>Église: <span id="summary-church">--</span></li>
                                        <li class="mb-2"><i class="fas fa-calendar me-2"></i>Trimestre: <span id="summary-quarter">--</span></li>
                                        <li class="mb-2"><i class="fas fa-users me-2"></i>Interventions: <span id="summary-count">0</span></li>
                                        <li class="mb-2"><i class="fas fa-map-marker-alt me-2"></i>Lieux: <span id="summary-places">--</span></li>
                                        <li class="mb-2"><i class="fas fa-user-friends me-2"></i>Intervenants: <span id="summary-intervenants">0</span></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="share-buttons">
                        <button type="button" class="btn btn-success-custom" id="generate-excel-btn">
                            <i class="fas fa-file-excel me-2"></i>Générer le fichier Excel
                        </button>

                        <button type="button" class="btn btn-outline-success" id="preview-excel-btn">
                            <i class="fas fa-eye me-2"></i>Prévisualiser
                        </button>

                        <button type="button" class="btn btn-outline-danger" id="customize-pdf-btn">
                            <i class="fas fa-file-pdf me-2"></i>Personnaliser le PDF
                        </button>

                        <button type="button" class="btn btn-outline-primary" id="generate-csv-btn">
                            <i class="fas fa-file-csv me-2"></i>Exporter en CSV
                        </button>

                        <button type="button" class="btn btn-outline-primary" id="whatsapp-share-btn" style="background: linear-gradient(135deg, #25D366, #128C7E); border: none; color: white;">
                            <i class="fab fa-whatsapp me-2"></i>Partager sur WhatsApp
                        </button>

                        <button type="button" class="btn btn-outline-primary" id="email-share-btn" style="background: linear-gradient(135deg, #007bff, #0056b3); border: none; color: white;">
                            <i class="fas fa-envelope me-2"></i>Partager par Email
                        </button>
                    </div>

                    <!-- Historique des partages -->
                    <div class="card mt-4" id="share-history-card" style="display: none;">
                        <div class="card-header bg-light text-dark">
                            <h6 class="mb-0"><i class="fas fa-history me-2"></i>Historique des générations et partages</h6>
                        </div>
                        <div class="card-body p-0">
                            <ul class="list-group list-group-flush" id="share-history-list">
                                <!-- Rempli dynamiquement -->
                            </ul>
                        </div>
                    </div>
                    
                    <div class="btn-row">
                        <button type="button" class="btn btn-outline-secondary" id="prev-step-3">
                            <i class="fas fa-arrow-left me-2"></i>Retour aux interventions
                        </button>
                        <button type="button" class="btn btn-outline-primary" id="new-planning-btn">
                            <i class="fas fa-plus me-2"></i>Nouveau planning
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Bouton de partage WhatsApp (flottant) -->
        <a href="#" class="whatsapp-share" id="whatsapp-share-float" style="display: none;">
            <i class="fab fa-whatsapp fa-2x"></i>
        </a>
        
        <!-- Bouton retour en haut -->
        <button class="floating-btn btn btn-primary-custom" onclick="window.scrollTo({top: 0, behavior: 'smooth'})">
            <i class="fas fa-arrow-up"></i>
        </button>
    </div>

    <!-- Modal de prévisualisation Excel -->
    <div class="modal fade" id="previewModal" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-file-excel me-2"></i>Prévisualisation Excel</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div id="modal-excel-preview"></div>
                </div>
                <div class="modal-footer">
                    <div class="btn-container">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                            <i class="fas fa-times me-2"></i>Fermer
                        </button>
                        <button type="button" class="btn btn-success" id="download-excel-btn">
                            <i class="fas fa-download me-2"></i>Télécharger
                        </button>
                        <button type="button" class="btn btn-success" id="whatsapp-modal-share" style="background: linear-gradient(135deg, #25D366, #128C7E); border: none;">
                            <i class="fab fa-whatsapp me-2"></i>Partager sur WhatsApp
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de configuration WhatsApp -->
    <div class="modal fade" id="whatsappModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fab fa-whatsapp text-success me-2"></i>Partager sur WhatsApp</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="whatsapp-form">
                        <div class="mb-3">
                            <label for="wa-filename" class="form-label">Nom du fichier PDF</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-file-pdf"></i></span>
                                <input type="text" class="form-control" id="wa-filename" required>
                                <span class="input-group-text">.pdf</span>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="wa-phone" class="form-label">Numéro du destinataire</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-phone"></i></span>
                                <input type="tel" class="form-control" id="wa-phone" placeholder="Ex: 97000000" value="+229 ">
                            </div>
                            <div class="form-text">Entrez le numéro avec l'indicatif (ex: +229...)</div>
                        </div>
                        <div class="alert alert-warning small">
                            <i class="fas fa-exclamation-triangle me-2"></i>
                            <strong>Important :</strong> Le fichier PDF sera d'abord téléchargé sur votre appareil. Vous devrez ensuite le <strong>joindre manuellement</strong> dans la conversation WhatsApp qui s'ouvrira.
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
                    <button type="button" class="btn btn-success" id="confirm-wa-send" style="background: linear-gradient(135deg, #25D366, #128C7E); border: none;">
                        <i class="fas fa-paper-plane me-2"></i>Confirmer et Envoyer
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de personnalisation du PDF -->
    <div class="modal fade" id="pdfCustomizationModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-file-pdf text-danger me-2"></i>Personnaliser le PDF</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="pdf-customization-form">
                        <div class="mb-3">
                            <label for="pdf-orientation" class="form-label">Orientation</label>
                            <select class="form-select" id="pdf-orientation">
                                <option value="portrait" selected>Portrait</option>
                                <option value="landscape">Paysage</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="pdf-format" class="form-label">Format</label>
                            <select class="form-select" id="pdf-format">
                                <option value="a4" selected>A4</option>
                                <option value="a3">A3</option>
                                <option value="letter">Lettre</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="pdf-margins" class="form-label">Marges (mm)</label>
                            <div class="row">
                                <div class="col-3">
                                    <input type="number" class="form-control" id="pdf-margin-top" placeholder="Haut" value="10">
                                </div>
                                <div class="col-3">
                                    <input type="number" class="form-control" id="pdf-margin-right" placeholder="Droite" value="10">
                                </div>
                                <div class="col-3">
                                    <input type="number" class="form-control" id="pdf-margin-bottom" placeholder="Bas" value="10">
                                </div>
                                <div class="col-3">
                                    <input type="number" class="form-control" id="pdf-margin-left" placeholder="Gauche" value="10">
                                </div>
                            </div>
                        </div>
                        <div class="mb-3 form-check">
                            <input class="form-check-input" type="checkbox" id="pdf-include-logo">
                            <label class="form-check-label" for="pdf-include-logo">
                                Inclure le logo
                            </label>
                        </div>
                        <div class="mb-3 form-check">
                            <input class="form-check-input" type="checkbox" id="pdf-include-headers" checked>
                            <label class="form-check-label" for="pdf-include-headers">
                                Inclure les en-têtes de colonnes
                            </label>
                        </div>
                        <div class="mb-3">
                            <label for="pdf-filename" class="form-label">Nom du fichier</label>
                            <div class="input-group">
                                <input type="text" class="form-control" id="pdf-filename">
                                <span class="input-group-text">.pdf</span>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
                    <button type="button" class="btn btn-success" id="confirm-pdf-customization">
                        <i class="fas fa-file-pdf me-2"></i>Générer le PDF
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    <!-- Bibliothèques PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.29/jspdf.plugin.autotable.min.js"></script>
    
    <!-- Input caché pour la sélection de fichier WhatsApp -->
    <input type="file" id="whatsapp-file-picker" style="display: none;" accept=".pdf, .xlsx, .xls, .application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel, application/pdf">

    <script src="script.js"></script>
</body>
</html>